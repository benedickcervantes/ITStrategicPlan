<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Expected ROI and Recommendations</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&amp;family=Roboto:wght@300;400;500&amp;display=swap" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script><style>
        * {
            box-sizing: border-box;
        }
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Roboto', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        @media (max-width: 768px) {
            html, body {
                overflow: auto !important;
                height: auto !important;
                display: block !important;
                -webkit-overflow-scrolling: touch;
            }
        }
        .slide {
            width: 100vw;
            height: 100vh;
            max-width: 1280px;
            max-height: 720px;
            position: relative;
            transform-origin: center center;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            will-change: transform, opacity, filter;
        }
        
        @keyframes slideInFromRight {
            0% {
                opacity: 0;
                transform: translateX(100vw) scale(0.98);
                filter: blur(8px) brightness(0.95);
            }
            60% {
                opacity: 0.9;
                filter: blur(3px) brightness(0.98);
            }
            100% {
                opacity: 1;
                transform: translateX(0) scale(1);
                filter: blur(0px) brightness(1);
            }
        }
        
        @keyframes slideInFromLeft {
            0% {
                opacity: 0;
                transform: translateX(-100vw) scale(0.98);
                filter: blur(8px) brightness(0.95);
            }
            60% {
                opacity: 0.9;
                filter: blur(3px) brightness(0.98);
            }
            100% {
                opacity: 1;
                transform: translateX(0) scale(1);
                filter: blur(0px) brightness(1);
            }
        }
        
        .slide.slide-out-left {
            animation: slideOutLeft 0.7s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
        }
        
        .slide.slide-out-right {
            animation: slideOutRight 0.7s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
        }
        
        @keyframes slideOutLeft {
            0% {
                opacity: 1;
                transform: translateX(0) scale(1);
                filter: blur(0px) brightness(1);
            }
            40% {
                opacity: 0.8;
                filter: blur(3px) brightness(0.98);
            }
            100% {
                opacity: 0;
                transform: translateX(-100vw) scale(0.98);
                filter: blur(8px) brightness(0.95);
            }
        }
        
        @keyframes slideOutRight {
            0% {
                opacity: 1;
                transform: translateX(0) scale(1);
                filter: blur(0px) brightness(1);
            }
            40% {
                opacity: 0.8;
                filter: blur(3px) brightness(0.98);
            }
            100% {
                opacity: 0;
                transform: translateX(100vw) scale(0.98);
                filter: blur(8px) brightness(0.95);
            }
        }
        
        .slide.slide-in-from-right {
            animation: slideInFromRight 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        
        .slide.slide-in-from-left {
            animation: slideInFromLeft 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        @media (min-aspect-ratio: 16/9) {
            .slide {
                width: calc(100vh * 16 / 9);
                height: 100vh;
            }
        }
        @media (max-aspect-ratio: 16/9) {
            .slide {
                width: 100vw;
                height: calc(100vw * 9 / 16);
            }
        }
        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            
            html, body {
                overflow: auto !important;
                height: auto !important;
                -webkit-overflow-scrolling: touch;
                position: relative;
            }
            .slide {
                width: 100vw;
                height: auto !important;
                min-height: 100vh;
                max-width: 100%;
                max-height: none !important;
                padding: clamp(12px, 3vw, 20px) !important;
                overflow: visible !important;
                display: block !important;
            }
            .grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            .grid-cols-3 {
                grid-template-columns: 1fr !important;
            }
            .grid-cols-5 {
                grid-template-columns: 1fr !important;
            }
            .budget-card, .category-card, .issue-card, .risk-card, .goal-card, .phase-card, .inventory-card, .info-card {
                padding: clamp(12px, 3vw, 20px) !important;
                margin-bottom: 12px;
            }
            h1, h2 {
                margin-bottom: clamp(8px, 2vw, 16px) !important;
            }
            .mb-8 {
                margin-bottom: clamp(16px, 4vw, 32px) !important;
            }
            .mb-4 {
                margin-bottom: clamp(12px, 3vw, 20px) !important;
            }
            .gap-8 {
                gap: clamp(12px, 3vw, 24px) !important;
            }
            .gap-6 {
                gap: clamp(10px, 2.5vw, 20px) !important;
            }
            .gap-4 {
                gap: clamp(8px, 2vw, 16px) !important;
            }
            table {
                font-size: clamp(9px, 2.5vw, 12px) !important;
                display: block;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                white-space: nowrap;
            }
            table thead, table tbody {
                display: table;
                width: 100%;
            }
            .nav-container {
                bottom: 10px;
                padding: 6px 10px;
                gap: 6px;
                width: auto;
                max-width: calc(100% - 20px);
                font-size: 0.75rem;
            }
            .nav-button {
                padding: 6px 10px;
                font-size: 0.75rem;
                min-height: 36px;
                min-width: auto;
                touch-action: manipulation;
                flex-shrink: 0;
            }
            .page-indicator {
                font-size: 0.75rem;
                padding: 0 6px;
            }
            .budget-card, .category-card {
                padding: 12px !important;
            }
            table {
                font-size: clamp(8px, 2vw, 11px) !important;
            /* Footer visibility on small mobile */
            div[class*="mt-auto"] {
                font-size: clamp(10px, 2.5vw, 12px) !important;
                opacity: 1 !important;
                margin-top: clamp(12px, 3vw, 20px) !important;
            }
            .slide {
                padding-bottom: clamp(70px, 15vw, 90px) !important; /* Extra space for nav + footer */
            }
        }
        @media (max-width: 480px) and (orientation: landscape) {
            .slide {
                padding: 8px !important;
            }
            .mb-8 {
                margin-bottom: 12px !important;
            }
            .mb-4 {
                margin-bottom: 8px !important;
            }
        }
        .nav-container {
                bottom: 12px;
                padding: 6px 16px;
                gap: 6px;
            }
            .nav-button {
                padding: 8px 12px;
                font-size: 0.85rem;
                min-height: 44px; /* Better touch target */
            }
            .page-indicator {
                font-size: 0.85rem;
                padding: 0 10px;
            }
        }
        @media (max-width: 480px) {
            .slide {
                padding: 12px !important;
            }
            h1 {
                font-size: clamp(20px, 6vw, 28px) !important;
            }
            .nav-container {
                flex-wrap: wrap;
                width: calc(100% - 24px);
                max-width: 320px;
            }
        }
        h1 {
            font-family: 'Montserrat', sans-serif;
        }
        .roi-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        .roi-card:hover {
            transform: translateY(-5px);
        }
        .icon-container {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .recommendation-item {
            border-left: 4px solid #F4A261;
            padding-left: 16px;
            margin-bottom: 16px;
        }
        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .chart-title-animate {
            animation: fadeInUp 0.8s ease-out 0.3s forwards;
            opacity: 0;
        }
        .chart-investment-animate {
            animation: fadeInUp 0.8s ease-out 0.5s forwards;
            opacity: 0;
        }
        .chart-container-animate {
            animation: fadeInUp 0.8s ease-out 0.7s forwards;
            opacity: 0;
        }
    
html {
    overflow: hidden;
}
        .nav-container {
            position: fixed;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(47, 62, 70, 0.85);
            padding: 4px 12px;
            border-radius: 20px;
            backdrop-filter: blur(8px);
        }
        .nav-button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 4px 10px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .nav-button:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }
        .nav-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .page-indicator {
            color: white;
            font-weight: 500;
            font-size: 0.75rem;
            padding: 0 8px;
        }
</style>
</head>
<body>
<div class="slide bg-gradient-to-br from-[#E0E1DD] to-[#EE6C4D]/10" style="padding: clamp(20px, 2.5vw, 40px);">
<!-- Header -->
<div class="mb-4 flex-shrink-0">
<h1 class="font-bold text-[#2F3E46] mb-2" style="font-size: clamp(24px, 3vw, 36px);">Expected ROI and Recommendations</h1>
<div class="h-1 bg-[#F4A261] rounded" style="width: clamp(80px, 10vw, 128px);"></div>
</div>
<!-- Main Content -->
<div class="flex-grow grid grid-cols-1 md:grid-cols-5 gap-4 min-h-0 overflow-hidden">
<!-- ROI Section - 3 columns -->
<div class="col-span-1 md:col-span-3 flex flex-col gap-3 min-h-0 overflow-y-auto">
<h2 class="font-bold text-[#006D77] mb-2 flex-shrink-0" style="font-size: clamp(18px, 2.2vw, 24px);">Expected Returns on Investment</h2>
<!-- ROI Cards -->
<div class="grid grid-cols-2 gap-3 flex-shrink-0" style="grid-template-rows: repeat(3, auto);">
<!-- Productivity Card -->
<div class="roi-card p-3 flex items-start">
<div class="icon-container bg-[#006D77] text-white mr-3 flex-shrink-0 flex items-center justify-center" style="width: clamp(40px, 4vw, 50px); height: clamp(40px, 4vw, 50px);">
<i class="fas fa-chart-line" style="font-size: clamp(14px, 1.6vw, 20px);"></i>
</div>
<div class="flex-1">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">Operational Efficiency Enhancement</h3>
<p class="text-[#2F3E46] mb-1" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Strategic hardware upgrades (16GB RAM, SSD storage) deliver measurable performance improvements: system boot times reduced from 5-10 minutes to under 30 seconds, application load times from 2-5 minutes to near-instantaneous response.</p>
<p class="text-[#006D77] text-xs font-semibold">Business Value: Estimated 15-20% workforce productivity increase, enhanced operational capacity, improved employee satisfaction and retention</p>
</div>
</div>
<!-- Downtime Card -->
<div class="roi-card p-3 flex items-start">
<div class="icon-container bg-[#EE6C4D] text-white mr-3 flex-shrink-0 flex items-center justify-center" style="width: clamp(40px, 4vw, 50px); height: clamp(40px, 4vw, 50px);">
<i class="fas fa-clock" style="font-size: clamp(14px, 1.6vw, 20px);"></i>
</div>
<div class="flex-1">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">Business Continuity Assurance</h3>
<p class="text-[#2F3E46] mb-1" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Critical infrastructure investment in server UPS replacement and enhanced power protection systems eliminates single points of failure, ensuring 99.9% service availability and protecting against data loss during power disruptions.</p>
<p class="text-[#EE6C4D] text-xs font-semibold">Business Value: Mitigated operational risk, guaranteed data integrity, sustained service delivery, reduced business interruption costs</p>
</div>
</div>
<!-- Security Card -->
<div class="roi-card p-3 flex items-start">
<div class="icon-container bg-[#F4A261] text-white mr-3 flex-shrink-0 flex items-center justify-center" style="width: clamp(40px, 4vw, 50px); height: clamp(40px, 4vw, 50px);">
<i class="fas fa-shield-alt" style="font-size: clamp(14px, 1.6vw, 20px);"></i>
</div>
<div class="flex-1">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">Cybersecurity Posture Strengthening</h3>
<p class="text-[#2F3E46] mb-1" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Software license regularization enables continuous security patching and threat mitigation. Strategic cloud migration and infrastructure modernization establish robust data protection frameworks aligned with industry best practices.</p>
<p class="text-[#F4A261] text-xs font-semibold">Business Value: Reduced cyber risk exposure, enhanced data protection, regulatory compliance alignment, minimized breach liability</p>
</div>
</div>
<!-- Compliance Card -->
<div class="roi-card p-3 flex items-start">
<div class="icon-container bg-[#006D77] text-white mr-3 flex-shrink-0 flex items-center justify-center" style="width: clamp(40px, 4vw, 50px); height: clamp(40px, 4vw, 50px);">
<i class="fas fa-check-circle" style="font-size: clamp(14px, 1.6vw, 20px);"></i>
</div>
<div class="flex-1">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">Regulatory Compliance &amp; Legal Risk Mitigation</h3>
<p class="text-[#2F3E46] mb-1" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Comprehensive software license regularization across 16 non-compliant systems eliminates legal exposure to vendor penalties and audit findings. Licensed software ensures system reliability, vendor support eligibility, and operational stability.</p>
<p class="text-[#006D77] text-xs font-semibold">Business Value: Eliminated legal and financial exposure, enhanced system reliability, authorized vendor support access, audit readiness</p>
</div>
</div>
<!-- Network Optimization Card -->
<div class="roi-card p-3 flex items-start">
<div class="icon-container bg-[#F4A261] text-white mr-3 flex-shrink-0 flex items-center justify-center" style="width: clamp(40px, 4vw, 50px); height: clamp(40px, 4vw, 50px);">
<i class="fas fa-network-wired" style="font-size: clamp(14px, 1.6vw, 20px);"></i>
</div>
<div class="flex-1">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">Network Infrastructure Optimization</h3>
<p class="text-[#2F3E46] mb-1" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Strategic ISP consolidation to 2-3 primary providers, implementation of dedicated LAN infrastructure, and comprehensive network documentation eliminate connectivity disruptions affecting 18 users, reducing IT support overhead by an estimated 60%.</p>
<p class="text-[#F4A261] text-xs font-semibold">Business Value: Improved service reliability, reduced operational overhead, enhanced scalability, optimized cost structure</p>
</div>
</div>
<!-- Modernization Card -->
<div class="roi-card p-3 flex items-start">
<div class="icon-container bg-[#EE6C4D] text-white mr-3 flex-shrink-0 flex items-center justify-center" style="width: clamp(40px, 4vw, 50px); height: clamp(40px, 4vw, 50px);">
<i class="fas fa-rocket" style="font-size: clamp(14px, 1.6vw, 20px);"></i>
</div>
<div class="flex-1">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">Digital Transformation Enablement</h3>
<p class="text-[#2F3E46] mb-1" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Strategic initiatives including cloud infrastructure migration, unified communications (VoIP/SIP), and digital presence development establish a foundation for scalable growth, operational efficiency, and competitive differentiation in the digital marketplace.</p>
<p class="text-[#EE6C4D] text-xs font-semibold">Business Value: Future-ready technology platform, reduced total cost of ownership, enhanced market positioning, accelerated business agility</p>
</div>
</div>
</div>
<!-- ROI Visualization -->
<div class="roi-chart mt-2 bg-white rounded-lg p-3 shadow flex-shrink-0">
<h3 class="font-bold text-[#2F3E46] mb-2 chart-title-animate" style="font-size: clamp(14px, 1.6vw, 18px);">Investment Impact Analysis</h3>
<div class="text-[#006D77] text-sm mb-2 chart-investment-animate" style="font-size: clamp(11px, 1.2vw, 14px);">Total Strategic Investment: ₱1,614,430</div>
<div class="w-full chart-container-animate" id="roi-chart" style="height: clamp(180px, 25vh, 250px);"></div>
</div>
</div>
<!-- Recommendations Section - 2 columns -->
<div class="col-span-1 md:col-span-2 bg-white rounded-lg p-4 shadow flex flex-col min-h-0 overflow-y-auto">
<h2 class="font-bold text-[#006D77] mb-3 flex-shrink-0" style="font-size: clamp(18px, 2.2vw, 24px);">Executive Recommendations</h2>
<div class="recommendation-item flex-shrink-0" style="border-left: 3px solid #F4A261; padding-left: clamp(12px, 1.5vw, 16px); margin-bottom: clamp(10px, 1.5vw, 16px);">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">1. Strategic Plan Approval</h3>
<p class="text-[#2F3E46]" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Approve the 2026 IT Strategic Plan and allocated budget of ₱1,614,430 to authorize critical infrastructure modernization and risk mitigation initiatives that directly support organizational objectives.</p>
</div>
<div class="recommendation-item flex-shrink-0" style="border-left: 3px solid #F4A261; padding-left: clamp(12px, 1.5vw, 16px); margin-bottom: clamp(10px, 1.5vw, 16px);">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">2. Immediate Phase 1 Execution (Q1 2026)</h3>
<p class="text-[#2F3E46]" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Prioritize immediate implementation of critical risk mitigation measures: server UPS replacement, strategic hardware upgrades for mission-critical users, and network infrastructure reinforcement to address highest-priority vulnerabilities.</p>
</div>
<div class="recommendation-item flex-shrink-0" style="border-left: 3px solid #F4A261; padding-left: clamp(12px, 1.5vw, 16px); margin-bottom: clamp(10px, 1.5vw, 16px);">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">3. Phased Implementation Strategy</h3>
<p class="text-[#2F3E46]" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Execute systematic Phase 2 upgrades (Q2 2026) and strategic Phase 3 modernization initiatives (Q3-Q4 2026) following established timelines to minimize operational disruption while maximizing value delivery.</p>
</div>
<div class="recommendation-item flex-shrink-0" style="border-left: 3px solid #F4A261; padding-left: clamp(12px, 1.5vw, 16px); margin-bottom: clamp(10px, 1.5vw, 16px);">
<h3 class="font-bold text-[#2F3E46] mb-1" style="font-size: clamp(13px, 1.5vw, 18px);">4. Performance Monitoring &amp; Governance</h3>
<p class="text-[#2F3E46]" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">Establish quarterly review cycles with key performance indicators (KPIs) to track implementation progress, measure return on investment, and enable data-driven decision-making for priority adjustments based on evolving business requirements.</p>
</div>
<div class="mt-auto p-3 bg-[#006D77]/10 rounded-lg border border-[#006D77]/20 flex-shrink-0">
<div class="flex items-center mb-2">
<i class="fas fa-lightbulb text-[#F4A261] mr-2" style="font-size: clamp(14px, 1.6vw, 20px);"></i>
<h3 class="font-bold text-[#2F3E46]" style="font-size: clamp(13px, 1.5vw, 18px);">Strategic Business Impact</h3>
</div>
<p class="text-[#2F3E46] mb-2" style="font-size: clamp(10px, 1.1vw, 14px); line-height: 1.4;">This strategic investment of ₱1,614,430 represents a critical enabler for organizational resilience, operational excellence, and sustainable competitive advantage in an increasingly digital business environment.</p>
<div class="grid grid-cols-2 gap-2 text-xs text-[#2F3E46]">
<div><strong>Immediate Benefits (0-6 months):</strong> Risk mitigation, regulatory compliance, operational efficiency improvements</div>
<div><strong>Sustained Value (12+ months):</strong> Scalable infrastructure foundation, optimized operational costs, digital transformation capabilities</div>
</div>
</div>
</div>
</div>
<!-- Footer -->
<div class="mt-auto pt-2 flex justify-between items-center text-[#2F3E46] opacity-70 flex-shrink-0" style="font-size: clamp(9px, 1.1vw, 13px); gap: 10px;">
<p>Based on IT Strategic Plan, 2026</p>
<p class="font-semibold">End of Report</p>
</div>
</div>
<script>
        // ROI Chart - Enhanced Vertical Bar Chart
        const roiData = [
            {category: "Productivity", value: 25, color: "#006D77"},
            {category: "Security", value: 20, color: "#F4A261"},
            {category: "Compliance", value: 18, color: "#006D77"},
            {category: "Downtime", value: 15, color: "#EE6C4D"},
            {category: "Network", value: 12, color: "#F4A261"},
            {category: "Modernization", value: 10, color: "#EE6C4D"}
        ];
        
        const chartContainer = document.getElementById("roi-chart");
        const chartWidth = chartContainer.offsetWidth || 500;
        const chartHeight = chartContainer.offsetHeight || 200;
        
        const svgWidth = Math.max(chartWidth, 500);
        const svgHeight = Math.max(chartHeight, 200);
        const margin = { top: 20, right: 20, bottom: 40, left: 20 };
        const chartWidthInner = svgWidth - margin.left - margin.right;
        const chartHeightInner = svgHeight - margin.top - margin.bottom;
        
        const roiChart = d3.select("#roi-chart")
            .append("svg")
            .attr("width", "100%")
            .attr("height", "100%")
            .attr("viewBox", `0 0 ${svgWidth} ${svgHeight}`)
            .attr("preserveAspectRatio", "xMidYMid meet");
        
        // Create scales for vertical bars
        const x = d3.scaleBand()
            .domain(roiData.map(d => d.category))
            .range([margin.left, svgWidth - margin.right])
            .padding(0.4);
            
        const y = d3.scaleLinear()
            .domain([0, d3.max(roiData, d => d.value) + 5])
            .range([chartHeightInner + margin.top, margin.top]);
            
        // Add vertical bars with animation
        roiChart.selectAll("rect")
            .data(roiData)
            .enter()
            .append("rect")
            .attr("x", d => x(d.category))
            .attr("y", chartHeightInner + margin.top)
            .attr("width", x.bandwidth())
            .attr("height", 0)
            .attr("fill", d => d.color)
            .attr("rx", 4)
            .attr("ry", 4)
            .transition()
            .duration(1200)
            .delay((d, i) => i * 150)
            .ease(d3.easeCubicOut)
            .attr("y", d => y(d.value))
            .attr("height", d => chartHeightInner + margin.top - y(d.value));
            
        // Add percentage values on top of bars with fade-in animation
        roiChart.selectAll(".value")
            .data(roiData)
            .enter()
            .append("text")
            .attr("class", "value")
            .attr("x", d => x(d.category) + x.bandwidth() / 2)
            .attr("y", d => y(d.value) - 5)
            .text(d => d.value + "%")
            .attr("text-anchor", "middle")
            .attr("fill", "#2F3E46")
            .attr("font-weight", "bold")
            .attr("font-size", Math.min(13, svgHeight * 0.08) + "px")
            .style("opacity", 0)
            .transition()
            .delay((d, i) => i * 150 + 1000)
            .duration(600)
            .style("opacity", 1);
            
        // Add category labels below bars
        roiChart.selectAll(".label")
            .data(roiData)
            .enter()
            .append("text")
            .attr("class", "label")
            .attr("x", d => x(d.category) + x.bandwidth() / 2)
            .attr("y", svgHeight - margin.bottom + 15)
            .text(d => d.category)
            .attr("text-anchor", "middle")
            .attr("fill", "#2F3E46")
            .attr("font-size", Math.min(11, svgHeight * 0.07) + "px");
            
        // Add dotted connecting lines between bars (from top right of one bar to top left of next)
        for (let i = 0; i < roiData.length - 1; i++) {
            roiChart.append("line")
                .attr("x1", x(roiData[i].category) + x.bandwidth())
                .attr("y1", y(roiData[i].value))
                .attr("x2", x(roiData[i+1].category))
                .attr("y2", y(roiData[i+1].value))
                .attr("stroke", "#E0E1DD")
                .attr("stroke-width", 2)
                .attr("stroke-dasharray", "3,3");
        }
    </script>
<!-- Navigation -->
<div class="nav-container">
    <button class="nav-button" onclick="goToPage(8)">
        <i class="fas fa-chevron-left"></i> Previous
    </button>
    <div class="page-indicator">Page 9 of 11</div>
    <button class="nav-button" onclick="goToPage(10)">
        Next <i class="fas fa-chevron-right"></i>
    </button>
</div>
<script>
    // Get current page number from URL
    const currentPage = parseInt(window.location.pathname.match(/page_(\d+)\.html/)?.[1] || '9');
    
    // Detect entry direction from sessionStorage
    const entryDirection = sessionStorage.getItem('slideDirection') || 'right';
    const slide = document.querySelector('.slide');
    
    // Apply entry animation based on direction
    if (entryDirection === 'left') {
        slide.classList.add('slide-in-from-left');
    } else {
        slide.classList.add('slide-in-from-right');
    }
    
    // Clear direction after animation
    setTimeout(() => {
        slide.classList.remove('slide-in-from-left', 'slide-in-from-right');
    }, 600);
    
    function goToPage(pageNum) {
        if (pageNum >= 1 && pageNum <= 11 && pageNum !== currentPage) {
            const direction = pageNum > currentPage ? 'right' : 'left';
            
            // Store direction for next page
            sessionStorage.setItem('slideDirection', direction);
            
            if (direction === 'right') {
                slide.classList.add('slide-out-left');
            } else {
                slide.classList.add('slide-out-right');
            }
            
            setTimeout(() => {
                window.location.href = `page_${pageNum}.html`;
            }, 600);
        }
    }
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
            e.preventDefault();
            if (e.key === 'ArrowLeft') {
                goToPage(8);
            } else if (e.key === 'ArrowRight') {
                goToPage(10);
            }
        }
    });
</script>
</body></html>